<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLEARCUT</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <style>
        .drop-zone {
            border: 2px dashed var(--tw-border-opacity, 1) #4a5568;
            transition: all 0.3s ease;
        }
        .drop-zone.dragover {
            border-color: #4299e1;
            background-color: #ebf8ff;
        }
        .loading {
            display: none;
        }
        .loading.active {
            display: flex;
        }
        .progress-bar {
            width: 100%;
            height: 4px;
            background-color: #e2e8f0;
            border-radius: 2px;
            overflow: hidden;
        }
        .progress-bar-fill {
            height: 100%;
            background-color: #4299e1;
            transition: width 0.3s ease;
        }
        html.dark {
            background: #18181b;
        }
        body.dark {
            background: #18181b;
        }
        /* Night mode for card and dropzone */
        .dark .bg-white {
            background-color: #23232a !important;
        }
        .dark .bg-gray-50 {
            background-color: #23232a !important;
        }
        .dark .border-gray-300 {
            border-color: #444456 !important;
        }
        .dark .shadow-2xl {
            box-shadow: 0 8px 32px 0 rgba(0,0,0,0.7);
        }
        .dark .text-gray-800, .dark .text-gray-700 {
            color: #f3f4f6 !important;
        }
        .dark .text-gray-600 {
            color: #d1d5db !important;
        }
        .dark .text-gray-500 {
            color: #a1a1aa !important;
        }
        .dark .bg-blue-500 {
            background-color: #2563eb !important;
        }
        .dark .hover\:bg-blue-600:hover {
            background-color: #1d4ed8 !important;
        }
        .dark .bg-green-500 {
            background-color: #22c55e !important;
        }
        .dark .hover\:bg-green-600:hover {
            background-color: #16a34a !important;
        }
        .dark .bg-gray-900 {
            background-color: #18181b !important;
        }
        .dark .rounded-2xl, .dark .rounded-xl, .dark .rounded-lg {
            box-shadow: 0 2px 8px 0 rgba(0,0,0,0.5);
        }
        .dark .shadow-md {
            box-shadow: 0 2px 8px 0 rgba(0,0,0,0.5);
        }
        .dark .focus\:ring-blue-500:focus {
            box-shadow: 0 0 0 2px #2563eb;
        }
        .dark .focus\:ring-green-500:focus {
            box-shadow: 0 0 0 2px #22c55e;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 min-h-screen transition-colors duration-300">
    <div class="w-full flex flex-col sm:flex-row sm:justify-between sm:items-center py-4 px-4 sm:px-6 bg-white dark:bg-gray-800 shadow-md sticky top-0 z-10 gap-2 sm:gap-0">
        <div class="flex items-center space-x-2 justify-center sm:justify-start">
            <svg class="w-8 h-8 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
            </svg>
            <span class="text-3xl font-extrabold tracking-widest text-gray-800 dark:text-gray-100">CLEARCUT</span>
        </div>
        <div class="flex flex-col sm:flex-row items-center sm:space-x-4 space-y-1 sm:space-y-0 justify-center sm:justify-end">
            <span class="text-xs sm:text-sm text-gray-600 dark:text-gray-300 font-semibold text-center sm:text-right">Created by <span class="text-blue-500">Lalit Shirsath</span></span>
            <label class="flex items-center cursor-pointer select-none mt-1 sm:mt-0">
                <span class="mr-2 text-gray-700 dark:text-gray-300 text-xs">Day</span>
                <div class="relative">
                    <input id="theme-toggle" type="checkbox" class="sr-only">
                    <div class="block bg-gray-400 w-12 h-6 rounded-full"></div>
                    <div class="dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition transform"></div>
                </div>
                <span class="ml-2 text-gray-700 dark:text-gray-300 text-xs">Night</span>
            </label>
        </div>
    </div>
    <div class="container mx-auto px-2 sm:px-4 py-8">
        <div class="max-w-2xl mx-auto">
            <div class="flex flex-col items-center mb-8">
                <span class="text-3xl sm:text-4xl font-extrabold tracking-widest text-blue-500 mb-2">CLEARCUT</span>
                <span class="text-base sm:text-lg text-gray-500 dark:text-gray-300 font-medium tracking-wide text-center">AI Background Remover</span>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-4 sm:p-8 transition-colors duration-300">
                <div id="drop-zone" class="drop-zone rounded-2xl p-6 sm:p-10 text-center cursor-pointer bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-700 border-2 border-dashed hover:shadow-lg transition-all duration-300">
                    <div class="space-y-4">
                        <svg class="mx-auto h-12 w-12 sm:h-14 sm:w-14 text-gray-400 dark:text-gray-500" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                            <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        <div class="text-gray-600 dark:text-gray-300">
                            <p class="text-base sm:text-lg font-semibold">Drag and drop your image here</p>
                            <p class="text-xs sm:text-sm">or</p>
                            <button id="browse-button" class="mt-2 px-4 sm:px-5 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition-all duration-200 text-sm sm:text-base">
                                Browse Files
                            </button>
                        </div>
                        <input type="file" id="file-input" class="hidden" accept="image/*">
                    </div>
                </div>
                <div id="loading" class="loading flex-col items-center justify-center mt-6 space-y-4">
                    <div class="w-full max-w-md">
                        <div class="progress-bar">
                            <div id="progress-bar-fill" class="progress-bar-fill" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"></div>
                        <span class="text-gray-600 dark:text-gray-300">Processing image...</span>
                    </div>
                    <div id="time-estimate" class="text-sm text-gray-500 dark:text-gray-400"></div>
                </div>
                <div id="preview" class="mt-6 hidden">
                    <div class="flex flex-col items-center space-y-6">
                        <div class="flex flex-col sm:flex-row justify-center items-center sm:space-x-8 space-y-4 sm:space-y-0 w-full">
                            <div class="text-center w-full sm:w-auto">
                                <h3 class="text-sm font-medium text-gray-700 dark:text-gray-200">Original</h3>
                                <img id="original-preview" class="mt-2 max-h-48 sm:max-h-56 rounded-xl shadow-md mx-auto" src="" alt="Original image">
                            </div>
                            <div class="text-center w-full sm:w-auto">
                                <h3 class="text-sm font-medium text-gray-700 dark:text-gray-200">Processed</h3>
                                <div class="relative mt-2 max-h-48 sm:max-h-56 flex items-center justify-center">
                                    <div id="processed-spinner" class="absolute inset-0 flex items-center justify-center">
                                        <div class="animate-spin rounded-full h-10 w-10 border-b-2 border-blue-500"></div>
                                    </div>
                                    <img id="processed-preview" class="max-h-48 sm:max-h-56 rounded-xl shadow-md hidden mx-auto" src="" alt="Processed image">
                                </div>
                            </div>
                        </div>
                        <div id="download-section" class="hidden w-full flex justify-center">
                            <button id="download-button" class="w-full sm:w-auto px-4 sm:px-7 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 flex items-center justify-center space-x-2 transition-all duration-200 text-sm sm:text-base">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                                </svg>
                                <span>Download Processed Image</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <footer class="mt-10 text-center text-gray-500 dark:text-gray-400 text-xs px-2 pb-4">
                &copy; 2025 <span class="text-blue-500 font-extrabold tracking-widest">CLEARCUT</span> by <span class="font-semibold">Lalit Shirsath</span>. All rights reserved.
            </footer>
        </div>
    </div>
    <script>
        // Theme toggle logic
        const themeToggle = document.getElementById('theme-toggle');
        const html = document.documentElement;
        const body = document.body;
        function setTheme(dark) {
            if (dark) {
                html.classList.add('dark');
                body.classList.add('dark');
                localStorage.setItem('theme', 'dark');
                document.querySelector('.dot').style.transform = 'translateX(24px)';
            } else {
                html.classList.remove('dark');
                body.classList.remove('dark');
                localStorage.setItem('theme', 'light');
                document.querySelector('.dot').style.transform = 'translateX(0)';
            }
        }
        // On load, set theme from localStorage
        if (localStorage.getItem('theme') === 'dark') {
            themeToggle.checked = true;
            setTheme(true);
        } else {
            themeToggle.checked = false;
            setTheme(false);
        }
        themeToggle.addEventListener('change', (e) => {
            setTheme(e.target.checked);
        });

        // Dropzone and upload logic
        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('file-input');
        const browseButton = document.getElementById('browse-button');
        const loading = document.getElementById('loading');
        const preview = document.getElementById('preview');
        const originalPreview = document.getElementById('original-preview');
        const processedPreview = document.getElementById('processed-preview');
        const progressBarFill = document.getElementById('progress-bar-fill');
        const timeEstimate = document.getElementById('time-estimate');
        const downloadButton = document.getElementById('download-button');
        const downloadSection = document.getElementById('download-section');
        let processedImageUrl = null;

        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, preventDefaults, false);
            document.body.addEventListener(eventName, preventDefaults, false);
        });
        ['dragenter', 'dragover'].forEach(eventName => {
            dropZone.addEventListener(eventName, highlight, false);
        });
        ['dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, unhighlight, false);
        });
        dropZone.addEventListener('drop', handleDrop, false);
        fileInput.addEventListener('change', handleFiles, false);
        browseButton.addEventListener('click', () => fileInput.click());
        downloadButton.addEventListener('click', () => {
            if (processedImageUrl) {
                const link = document.createElement('a');
                link.href = processedImageUrl;
                link.download = 'removed_background.png';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        });
        function preventDefaults (e) {
            e.preventDefault();
            e.stopPropagation();
        }
        function highlight(e) {
            dropZone.classList.add('dragover');
        }
        function unhighlight(e) {
            dropZone.classList.remove('dragover');
        }
        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles({ target: { files: files } });
        }
        function handleFiles(e) {
            const file = e.target.files[0];
            if (file && file.type.startsWith('image/')) {
                uploadFile(file);
            }
        }
        function updateProgress(progress) {
            progressBarFill.style.width = `${progress}%`;
            if (progress < 30) {
                timeEstimate.textContent = 'Analyzing image...';
            } else if (progress < 60) {
                timeEstimate.textContent = 'Removing background...';
            } else if (progress < 90) {
                timeEstimate.textContent = 'Finalizing...';
            } else {
                timeEstimate.textContent = 'Almost done...';
            }
        }
        function uploadFile(file) {
            const formData = new FormData();
            formData.append('file', file);
            const reader = new FileReader();
            reader.onload = function(e) {
                originalPreview.src = e.target.result;
                preview.classList.remove('hidden');
            }
            reader.readAsDataURL(file);
            loading.classList.add('active');
            progressBarFill.style.width = '0%';
            timeEstimate.textContent = 'Starting process...';
            downloadSection.classList.add('hidden');
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += 5;
                if (progress <= 95) {
                    updateProgress(progress);
                }
            }, 200);
            fetch('/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.blob();
            })
            .then(blob => {
                clearInterval(progressInterval);
                updateProgress(100);
                processedImageUrl = URL.createObjectURL(blob);
                processedPreview.onload = function() {
                    document.getElementById('processed-spinner').style.display = 'none';
                    processedPreview.classList.remove('hidden');
                };
                processedPreview.src = processedImageUrl;
                setTimeout(() => {
                    loading.classList.remove('active');
                    downloadSection.classList.remove('hidden');
                }, 500);
            })
            .catch(error => {
                clearInterval(progressInterval);
                console.error('Error:', error);
                loading.classList.remove('active');
                document.getElementById('processed-spinner').style.display = 'none';
                processedPreview.classList.add('hidden');
                alert('An error occurred while processing the image. Please try again.');
            });
        }
    </script>
</body>
</html> 